<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://defra.github.io/ffc-development-guide/guides/resource-provisioning/release-pipeline/" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Release pipelines - FCP Development Guide</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Release pipelines";
        var mkdocs_page_input_path = "guides/resource-provisioning/release-pipeline.md";
        var mkdocs_page_url = "/ffc-development-guide/guides/resource-provisioning/release-pipeline/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> FCP Development Guide
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Farming and Countryside Programme (FCP) Development Guide</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../arrange-access/">Arrange access</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../getting-started/">Getting started</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../platform/">Platform</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Guides</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../../">Guides</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../accounts/">Accounts</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../availability-alerts/">Availability Alert Setup Guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../backlog-management/">Backlog management</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../collaboration/">Collaboration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../debug-dotnet-container/">Debugging .NET Core in a Linux container</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../demo-service/">Demo service</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../developing-in-container/">Developing in a container</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../google-tag-manager/">Google Tag Manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../jenkins/">Jenkins</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../jlm/">Joiners, movers and leavers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../pact-broker/">Pact Broker</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../redis-caching/">Redis Caching in Hapi</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../secrets-management/">Secrets Management</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../shared-assets/">Shared assets</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../troubleshooting/">Troubleshooting Guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../vs-code-wsl1/">Using Visual Studio Code with WSL1</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../vulnerabilities/">Managing vulnerabilities</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../waf-waiver/">WAF waivers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Kubernetes</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../kubernetes/">Kubernetes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kubernetes/configure-nginx-ingress-controller/">Configure NGINX Ingress Controller</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kubernetes/create-namespace/">Creating a workstream namespace</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kubernetes/install-kubernetes-dashboard/">Install Kubernetes dashboard</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kubernetes/interaction/">Interact with cluster</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kubernetes/pod-identity/">AAD Pod Identity</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kubernetes/probes/">Probes</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Resource provisioning</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../">Resource provisionsing</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../ci-pipeline/">FFC CI Pipeline</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../managed-identity/">Azure Managed Identity</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../postgres-database/">Postgres Database</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="./">Release pipelines</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#sandpit">Sandpit</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#configure-sandpit-release-pipeline">Configure sandpit release pipeline</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#development-test-preproduction-and-production-release-pipelines">Development, Test, PreProduction and Production release pipelines</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#preparations-for-higher-environments">Preparations for higher environments</a>
    </li>
        </ul>
    </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../servicebus-queues/">Azure Service Bus Queues, Topics and Subscriptions</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Local development setup</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../local-development-setup/">Setup local development environment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../local-development-setup/install-azure-cli/">Install Azure CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../local-development-setup/install-detect-secrets/">Install Detect Secrets</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../local-development-setup/install-docker-compose/">Install Docker Compose</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../local-development-setup/install-docker-desktop/">Install Docker Desktop</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../local-development-setup/install-dotnet-sdk/">Install .NET SDK</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../local-development-setup/install-github/">Install GitHub CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../local-development-setup/install-kubectl/">Install kubectl</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../local-development-setup/install-node-version-manager/">Install Node Version Manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../local-development-setup/install-openvpn/">Install OpenVPN</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../local-development-setup/install-snyk/">Install Snyk CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../local-development-setup/install-sonarlint/">Install SonarLint</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../local-development-setup/install-standard-js/">Install StandardJs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../local-development-setup/install-vs-code/">Install IDE</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../local-development-setup/install-wsl/">Install Windows Subsystem for Linux (WSL)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../local-development-setup/installing-helm/">Install Helm</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../local-development-setup/mount-windows-drives-in-wsl/">Mount Windows drives in WSL</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../local-development-setup/setup-macos-command-line-tools/">Setup command line tools</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../local-development-setup/setup-sudoers/">Add user to sudoers file</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../local-development-setup/sign-commits/">Setup commit signing</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Standards</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../standards/">Standards</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../standards/api/">API Standards</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../standards/backlog-management/">Backlog management</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../standards/ci-pipeline/">FFC CI pipeline</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../standards/code-review/">Code review</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../standards/configuration-management/">Configuration management</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../standards/documentation/">Documentation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../standards/events/">Events and messages</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../standards/jenkins/">Jenkins</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../standards/quick-reference/">Quick reference</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../standards/release-notes/">Release notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../standards/route-to-live/">Route to live</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../standards/secrets-management/">Secrets Management</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../standards/source-code/">Source code</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../standards/technology-stack/">Technology Stack</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../standards/testing/">Testing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../standards/version-control/">Version Control</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Kubernetes</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../standards/kubernetes/">Kubernetes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../standards/kubernetes/configuration/">Configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../standards/kubernetes/helm-charts/">Helm chart</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../standards/kubernetes/labels/">Labels</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../standards/kubernetes/priority/">Pod priority</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../standards/kubernetes/probes/">Probes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../standards/kubernetes/rbac/">Role Based Access Control (RBAC)</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../standards/kubernetes/resource-usage/">Resource usage</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../standards/kubernetes/secrets/">Secrets</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">FCP Development Guide</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Guides</li>
          <li class="breadcrumb-item">Resource provisioning</li>
      <li class="breadcrumb-item active">Release pipelines</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="release-pipelines">Release pipelines</h1>
<h2 id="sandpit">Sandpit</h2>
<p>Sandpit release pipelines are run from Jenkins and a deployment to the sandpit environment is automatically triggered by the CI pipeline if building from a main branch.</p>
<h3 id="configure-sandpit-release-pipeline">Configure sandpit release pipeline</h3>
<ul>
<li>navigate to your workstream folder in Jenkins</li>
<li>creating a new credential is optional and if not done, the value of <code>default-deploy-token</code> should be used</li>
<li>select <code>Credentials -&gt; (global) -&gt; Add Credentials</code></li>
<li>select <code>Secret text</code> type and set both <code>Description</code> and <code>Id</code> to <code>&lt;respository name&gt;-deploy-token</code>, for example <code>ffc-demo-web-deploy-token</code></li>
<li>set the secret value to be a unique string, this value will be used to authenticate the CI pipeline when triggering a release</li>
<li>navigate to your workspace folder and select <code>New Item</code></li>
<li>enter the <code>item name</code> in the format <code>&lt;repository name&gt;-deploy</code>, for example <code>ffc-demo-web-deploy</code></li>
<li>select <code>Pipeline</code></li>
<li>select <code>Ok</code></li>
<li>set <code>This project is parameterised</code> to <code>true</code> and add the following <code>string</code> parameters</li>
</ul>
<table>
<thead>
<tr>
<th>Name</th>
<th>Default Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>chartVersion</code></td>
<td><code>1.0.0</code></td>
<td><code>Version of service to deploy</code></td>
</tr>
<tr>
<td><code>chartName</code></td>
<td><code>&lt;repository name&gt;</code> for example, <code>ffc-demo-web</code></td>
<td><code>Service to deploy</code></td>
</tr>
<tr>
<td><code>namespace</code></td>
<td><code>ffc-&lt;service name&gt;</code> for example, <code>ffc-grants</code></td>
<td><code>Cluster namespace to deploy to</code></td>
</tr>
<tr>
<td><code>environment</code></td>
<td><code>dev</code></td>
<td><code>Cluster environment to deploy to</code></td>
</tr>
<tr>
<td><code>helmChartRepoType</code></td>
<td><code>acr</code></td>
<td><code>Location of Helm charts</code></td>
</tr>
</tbody>
</table>
<ul>
<li>set <code>Trigger builds remotely</code> to <code>true</code></li>
<li>enter unique deploy token created above</li>
<li>add inline pipeline script with the following content</li>
</ul>
<p>```
  @Library('defra-library@v-9') _</p>
<p>deployToCluster environment: params.environment,
                namespace: params.namespace,
                chartName: params.chartName,
                chartVersion: params.chartVersion,
                helmChartRepoType: params.helmChartRepoType
  <code>``
- select</code>Save`</p>
<h2 id="development-test-preproduction-and-production-release-pipelines">Development, Test, PreProduction and Production release pipelines</h2>
<p>Release pipelines to higher environments are run from Azure DevOps using a common microservice pipeline.</p>
<p>A deployment to the development and test environments environment are automatically triggered following a build from a main branch.  These pipelines can also be run manually by delivery teams.</p>
<p>Deployments to PreProd require a ticket raised with CCoE.</p>
<p>Deployments to Production require an RFC raised in myIT to authorise CCoE to deploy.</p>
<h3 id="preparations-for-higher-environments">Preparations for higher environments</h3>
<p>Teams should ensure they have completed the following before deploying to higher environments.</p>
<ul>
<li>Update Azure Application Configuration is updated with all required Helm chart configurations</li>
<li>Share any new databases created with the Platform team.  The release pipelines are currently dependent on knowing which services have databases in advance.  This is expected to change in the near future.</li>
<li>Ensure all managed identities are created</li>
<li>Ensure all Service Bus queues are created</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../postgres-database/" class="btn btn-neutral float-left" title="Postgres Database"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../servicebus-queues/" class="btn btn-neutral float-right" title="Azure Service Bus Queues, Topics and Subscriptions">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../postgres-database/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../servicebus-queues/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
