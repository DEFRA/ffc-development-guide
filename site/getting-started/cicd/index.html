<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://defra.github.io/ffc-development-guide/getting-started/cicd/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Continuous Integration and Continuous Delivery (CI/CD) - FCP Development Guide</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Continuous Integration and Continuous Delivery (CI/CD)";
        var mkdocs_page_input_path = "getting-started/cicd.md";
        var mkdocs_page_url = "/ffc-development-guide/getting-started/cicd/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> FCP Development Guide
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Farming and Countryside Programme (FCP) Development Guide</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Create a new service</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../create-a-new-service/">Create a new service</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Getting started</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../">Getting started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../arrange-access/">Arrange access</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Continuous Integration and Continuous Delivery (CI/CD)</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#continuous-integration-ci">Continuous Integration (CI)</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#supported-technologies">Supported technologies</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#pipeline-stages">Pipeline stages</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#build-steps">Build steps</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#clean-up-steps">Clean up steps</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#continuous-delivery-cd">Continuous Delivery (CD)</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../platform/">Platform</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Local development setup</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../local-development-setup/">Setup local development environment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../local-development-setup/install-azure-cli/">Install Azure CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../local-development-setup/install-detect-secrets/">Install Detect Secrets</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../local-development-setup/install-docker-compose/">Install Docker Compose</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../local-development-setup/install-docker-desktop/">Install Docker Desktop</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../local-development-setup/install-dotnet-sdk/">Install .NET SDK</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../local-development-setup/install-github/">Install GitHub CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../local-development-setup/install-kubectl/">Install kubectl</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../local-development-setup/install-node-version-manager/">Install Node Version Manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../local-development-setup/install-openvpn/">Install OpenVPN</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../local-development-setup/install-snyk/">Install Snyk CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../local-development-setup/install-sonarlint/">Install SonarLint</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../local-development-setup/install-standard-js/">Install StandardJs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../local-development-setup/install-vs-code/">Install IDE</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../local-development-setup/install-wsl/">Install Windows Subsystem for Linux (WSL)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../local-development-setup/installing-helm/">Install Helm</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../local-development-setup/mount-windows-drives-in-wsl/">Mount Windows drives in WSL</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../local-development-setup/setup-macos-command-line-tools/">Setup command line tools</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../local-development-setup/setup-sudoers/">Add user to sudoers file</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../local-development-setup/sign-commits/">Setup commit signing</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Z content to be revised</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="#">Guides</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/guides/">Guides</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/guides/accounts/">Accounts</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/guides/availability-alerts/">Availability Alert Setup Guide</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/guides/backlog-management/">Backlog management</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/guides/debug-dotnet-container/">Debugging .NET Core in a Linux container</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/guides/demo-service/">Demo service</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/guides/developing-in-container/">Developing in a container</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/guides/google-tag-manager/">Google Tag Manager</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/guides/jlm/">Joiners, movers and leavers</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/guides/pact-broker/">Pact Broker</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/guides/redis-caching/">Redis Caching in Hapi</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/guides/secrets-management/">Secrets Management</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/guides/shared-assets/">Shared assets</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/guides/troubleshooting/">Troubleshooting Guide</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/guides/vs-code-wsl1/">Using Visual Studio Code with WSL1</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/guides/vulnerabilities/">Managing vulnerabilities</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/guides/waf-waiver/">WAF waivers</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">Kubernetes</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../z_content-to-be-revised/guides/kubernetes/">Kubernetes</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../z_content-to-be-revised/guides/kubernetes/configure-nginx-ingress-controller/">Configure NGINX Ingress Controller</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../z_content-to-be-revised/guides/kubernetes/create-namespace/">Creating a workstream namespace</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../z_content-to-be-revised/guides/kubernetes/install-kubernetes-dashboard/">Install Kubernetes dashboard</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../z_content-to-be-revised/guides/kubernetes/interaction/">Interact with cluster</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../z_content-to-be-revised/guides/kubernetes/pod-identity/">AAD Pod Identity</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../z_content-to-be-revised/guides/kubernetes/probes/">Probes</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">Resource provisioning</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../z_content-to-be-revised/guides/resource-provisioning/">Resource provisionsing</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../z_content-to-be-revised/guides/resource-provisioning/ci-pipeline/">FFC CI Pipeline</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../z_content-to-be-revised/guides/resource-provisioning/managed-identity/">Azure Managed Identity</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../z_content-to-be-revised/guides/resource-provisioning/postgres-database/">Postgres Database</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../z_content-to-be-revised/guides/resource-provisioning/release-pipeline/">Release pipelines</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../z_content-to-be-revised/guides/resource-provisioning/servicebus-queues/">Azure Service Bus Queues, Topics and Subscriptions</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Standards</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/standards/">Standards</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/standards/api/">API Standards</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/standards/backlog-management/">Backlog management</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/standards/ci-pipeline/">FFC CI pipeline</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/standards/code-review/">Code review</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/standards/configuration-management/">Configuration management</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/standards/documentation/">Documentation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/standards/events/">Events and messages</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/standards/jenkins/">Jenkins</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/standards/quick-reference/">Quick reference</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/standards/release-notes/">Release notes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/standards/route-to-live/">Route to live</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/standards/secrets-management/">Secrets Management</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/standards/source-code/">Source code</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/standards/technology-stack/">Technology Stack</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/standards/testing/">Testing</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../z_content-to-be-revised/standards/version-control/">Version Control</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">Kubernetes</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../z_content-to-be-revised/standards/kubernetes/">Kubernetes</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../z_content-to-be-revised/standards/kubernetes/configuration/">Configuration</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../z_content-to-be-revised/standards/kubernetes/helm-charts/">Helm chart</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../z_content-to-be-revised/standards/kubernetes/labels/">Labels</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../z_content-to-be-revised/standards/kubernetes/priority/">Pod priority</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../z_content-to-be-revised/standards/kubernetes/probes/">Probes</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../z_content-to-be-revised/standards/kubernetes/rbac/">Role Based Access Control (RBAC)</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../z_content-to-be-revised/standards/kubernetes/resource-usage/">Resource usage</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../z_content-to-be-revised/standards/kubernetes/secrets/">Secrets</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">FCP Development Guide</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Getting started</li>
      <li class="breadcrumb-item active">Continuous Integration and Continuous Delivery (CI/CD)</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="continuous-integration-and-continuous-delivery-cicd">Continuous Integration and Continuous Delivery (CI/CD)</h1>
<p>For the FCP Platform, <a href="https://jenkins-ffc.azure.defra.cloud/">Jenkins</a> is used for CI pipelines, whilst <a href="https://dev.azure.com/defragovuk/DEFRA-FFC">Azure DevOps</a> is used for CD.</p>
<p>Originally the FCP Platform was primarily hosted on <a href="https://aws.amazon.com/">AWS</a> where Jenkins was prescribed as the CI/CD tool.  However, as the platform has migrated to <a href="https://azure.microsoft.com/">Azure</a>, Azure DevOps was prescribed as the CD tool.  Jenkins is still used for CI pipelines as it is a well established tool within the programme and redevelopment of the pipelines in Azure DevOps would be a significant undertaking.</p>
<h2 id="continuous-integration-ci">Continuous Integration (CI)</h2>
<p>FCP adopt a "shift left" approach to security and quality, meaning that security and quality checks are performed as early as possible in the development lifecycle.  The CI pipeline is designed around this principle and looks to provide fast feedback to developers and testers prior to merging code to the main branch.</p>
<p>Feature branch development allows for small changes to be made and tested in isolation.  This is supported by the CI pipeline which will run a subset of tests and checks on a feature branch build.  The pipeline will also provision a dedicated environment for the feature branch build to be deployed to, allowing for a more comprehensive set of tests to be run.</p>
<p>In order to avoid duplication across all microservices, a <a href="https://github.com/DEFRA/ffc-jenkins-pipeline-library">common Jenkins pipeline</a> has been created.</p>
<blockquote>
<p>Note that a feature branch must have an open Pull Request in order for the CI pipeline to run.</p>
</blockquote>
<h3 id="supported-technologies">Supported technologies</h3>
<p>The CI pipeline supports the following technologies:</p>
<ul>
<li>Containerised Node.js applications targetting Azure Kubernetes Service (AKS)</li>
<li>Containerised .NET applications targetting Azure Kubernetes Service (AKS)</li>
<li>Helm charts</li>
<li>Azure Functions</li>
<li>Docker images</li>
<li>npm packages</li>
</ul>
<h3 id="pipeline-stages">Pipeline stages</h3>
<h2 id="build-steps">Build steps</h2>
<p>The steps for a feature or main branch build are more or less the same.  The most significant difference is there is no feature branch deployment for a main build.  Instead additional build assets are created ready to be promoted to higher environments.</p>
<p>Below shows the pipeline steps for building a Node.js application targetting AKS.  The steps for other technologies are similar.  Anywhere <code>CUSTOM INJECTION</code> is shown custom steps can be injected.</p>
<p>Some steps are optional depending on the content of the repository.</p>
<ol>
<li>Validate semantic version of package</li>
<li>Lint Helm chart</li>
<li>npm Audit vulnerability check</li>
<li>Snyk vulnerability check</li>
<li><code>CUSTOM INJECTION</code></li>
<li>Build test Docker image</li>
<li>Provision dynamic infrastructure for feature branch and to support integration tests</li>
<li><code>CUSTOM INJECTION</code></li>
<li>Run containerised tests (linting, unit, integration, contract)  </li>
<li><code>CUSTOM INJECTION</code></li>
<li>Publish contracts to Pact Broker</li>
<li>SonarCloud static code analysis</li>
<li>Build production Docker image</li>
<li>Publish image to to Azure Container Registry</li>
<li>Deploy image to dynamic AKS namespace (feature branch build only)</li>
<li>AXE accessibility tests (optional)</li>
<li>BrowserStack containerised UI and compatibility tests (optional)</li>
<li>OWASP Zap security tests (optional)</li>
<li>JMeter performance tests (optional)</li>
<li>Publish Helm chart to AZure Container Registry (main branch build only)</li>
<li><code>CUSTOM INJECTION</code></li>
<li>Create GitHub release (main branch build only)</li>
<li>Clean up build specific dynamic infrastructure</li>
<li><code>CUSTOM INJECTION</code></li>
</ol>
<h2 id="clean-up-steps">Clean up steps</h2>
<p>Once a feature branch is deleted, the clean up process will automatically run to remove any dynamic infrastructure.</p>
<h2 id="continuous-delivery-cd">Continuous Delivery (CD)</h2>
<p>Once a feature branch has been merged into the main branch, the CI pipeline will automatically run to package the assets and deploy the application to the Sandpit environment.  Assuming the Sandpit deployment was successful, Jenkins will then trigger Azure DevOps to deploy the application to the higher environments.</p>
<p>ADO will deploy the application to the following environments once the previous environment has been successfully deployed to:</p>
<ul>
<li>Development (automatic)</li>
<li>Test (requires approval from anyone in the team)</li>
<li>PreProduction (requires approval from anyone in the team)</li>
<li>Production (requires approval from CCoE and an Request for Change (RFC))</li>
</ul>
<blockquote>
<p>Note that some of the more mature teams in FCP have approval to run their own changes to Production using a standard change.</p>
</blockquote>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../arrange-access/" class="btn btn-neutral float-left" title="Arrange access"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../platform/" class="btn btn-neutral float-right" title="Platform">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../arrange-access/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../platform/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
